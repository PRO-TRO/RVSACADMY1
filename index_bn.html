‡¶è‡¶á‡¶ö‡¶ü‡¶ø‡¶è‡¶Æ‡¶è‡¶≤
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>
   Gamified Learning Hub
  </title>
<script src="https://cdn.tailwindcss.com">
</script>
<style>
   /* Small extra styles to complement Tailwind */
    html,body,#app{height:100%}
    .bg-hero{background:linear-gradient(135deg,#0f172a 0%,#001219 60%)}
    .card-glow{box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    .btn-primary{background:linear-gradient(90deg,#06b6d4,#3b82f6);color:white}
    .big-timer{font-weight:700;font-size:2.2rem}
    .game-target{width:60px;height:60px;border-radius:9999px;position:absolute}
  </style>
</head>
<body class="bg-hero text-slate-100 antialiased">
<div class="min-h-screen flex items-center justify-center p-6" id="app">
<div class="w-full max-w-6xl">
<header class="flex items-center justify-between mb-6">
<h1 class="text-3xl font-extrabold">
      üéÆ ‡¶ó‡ßá‡¶Æ‡¶ø‡¶´‡¶æ‡¶á‡¶° ‡¶≤‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶π‡¶æ‡¶¨
     </h1>
<div class="flex items-center gap-3">
<div class="text-sm opacity-90" id="welcome">
</div>
<button class="px-4 py-2 rounded-lg border border-slate-700" id="openAuth">
       ‡¶≤‡¶ó‡¶á‡¶® / ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶®
      </button>
</div>
</header>
<!-- Unified Language Dropdown (auto-inserted) -->
<style>
      #langSwitcher {
        margin: 12px auto;
        text-align: center;
      }
      #langSelect {
        padding: 6px 10px;
        border-radius: 6px;
        border: 1px solid #ccc;
        font-size: 14px;
        cursor: pointer;
      }
      #langLabel {
        margin-right: 8px;
        font-weight: 600;
      }
    </style>
<div id="langSwitcher">
<label for="langSelect" id="langLabel">üåê Language:</label>
<select id="langSelect" onchange="switchLanguage(this.value)">
<option value="">English</option><option value="_hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option><option value="_bho">‡§≠‡•ã‡§ú‡§™‡•Å‡§∞‡•Ä</option><option selected="" value="_bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
</select>
</div>
<script>
    (function(){
      const suffixRegex = new RegExp("(_hi|_bho|_bn)?\.html$");
      window.switchLanguage = function(suffix) {
          const current = window.location.pathname.split('/').pop() || '';
          const folder = window.location.pathname.replace(/[^/]*$/,'');
          // remove any of the known suffixes + .html from the filename
          const base = current.replace(suffixRegex, '');
          const newFile = base + (suffix || '') + '.html';
          window.location.href = folder + newFile + window.location.search + window.location.hash;
      };
    })();
    </script>

<!-- Unified Language Dropdown (auto-inserted) -->
<style>
      #langSwitcher {
        margin: 12px auto;
        text-align: center;
      }
      #langSelect {
        padding: 6px 10px;
        border-radius: 6px;
        border: 1px solid #ccc;
        font-size: 14px;
        cursor: pointer;
      }
      #langLabel {
        margin-right: 8px;
        font-weight: 600;
      }
    </style>

<script>
    (function(){
      const suffixRegex = new RegExp("(_hi|_bho|_bn)?\.html$");
      window.switchLanguage = function(suffix) {
          const current = window.location.pathname.split('/').pop() || '';
          const folder = window.location.pathname.replace(/[^/]*$/,'');
          // remove any of the known suffixes + .html from the filename
          const base = current.replace(suffixRegex, '');
          const newFile = base + (suffix || '') + '.html';
          window.location.href = folder + newFile + window.location.search + window.location.hash;
      };
    })();
    </script>
<!-- Unified Language Dropdown -->
<style>
      #langSwitcher {
        margin: 12px auto;
        text-align: center;
      }
      #langSelect {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 8px 14px;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
      }
      #langSelect:hover {
        background-color: #0056b3;
      }
    </style>
<script>
    function switchLanguage(suffix) {
        const current = window.location.pathname.split('/').pop() || '';
        const folder = window.location.pathname.replace(/[^/]*$/, '');
        const base = current.replace(/(_hi|_bho|_bn)?\.html$/, '');
        const newFile = base + (suffix || '') + '.html';
        window.location.href = folder + newFile + window.location.search + window.location.hash;
    }
    </script>
<!-- Language Switcher (Safe) -->
<script>
      function switchLanguage(suffix) {
        const file = window.location.pathname.split('/').pop();
        const folder = window.location.pathname.replace(/[^/]*$/, '');
        const base = file.replace(/(_hi|_bho|_bn)?\.html$/, '');
        const target = base + (suffix || '') + '.html';
        window.location.href = folder + target;
      }
    </script>
<!-- Language Switcher (Dropdown) -->
<style>
     #langSwitcher {
        margin: 16px auto;
        text-align: center;
      }
      #langSelect {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 8px 14px;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
      }
      #langSelect:hover {
        background-color: #0056b3;
      }
    </style>
<script>
     function switchLanguage(suffix) {
        const current = window.location.pathname.split('/').pop() || '';
        const folder = window.location.pathname.replace(/[^/]*$/, '');
        const base = current.replace(/(_hi|_bho|_bn)?\.html$/, '');
        const newFile = base + (suffix || '') + '.html';
        window.location.href = folder + newFile + window.location.search + window.location.hash;
    }
    </script>
<!-- Language Switcher (Dropdown) -->
<style>
     #langSwitcher {
        margin: 16px auto;
        text-align: center;
      }
      #langSelect {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 8px 14px;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
      }
      #langSelect:hover {
        background-color: #0056b3;
      }
    </style>
<script>
     function switchLanguage(suffix) {
        const current = window.location.pathname.split('/').pop() || '';
        const folder = window.location.pathname.replace(/[^/]*$/, '');
        const base = current.replace(/(_hi|_bho|_bn)?\.html$/, '');
        const newFile = base + (suffix || '') + '.html';
        window.location.href = folder + newFile + window.location.search + window.location.hash;
    }
    </script>
<main class="grid grid-cols-1 md:grid-cols-3 gap-6">
<!-- Left column: User / Timer / Progress -->
<section class="col-span-1 bg-slate-800/30 p-5 rounded-2xl card-glow">
<h2 class="text-xl font-semibold mb-2">
       ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞
      </h2>
<div class="space-y-3" id="profileBox">
<div class="text-sm text-slate-300">
        ‡¶≤‡¶ó ‡¶á‡¶® ‡¶®‡ßá‡¶á
       </div>
<div class="flex items-center gap-2">
<div class="big-timer" id="dailyTimer">
         -:-:--
        </div>
</div>
<div class="text-xs text-slate-400">
        ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞‡ßá 24 ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶ï‡ßÅ‡¶á‡¶ú‡¶ï‡ßá ‡¶≤‡¶ï ‡¶ï‡¶∞‡ßá‡•§ ‡¶è‡¶ü‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶ï‡ßÅ‡¶á‡¶ú ‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø 24 ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßá‡•§
       </div>
<div class="mt-3">
<div class="text-sm font-medium">
         ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ß‡¶æ‡¶∞‡¶æ:
         <span id="streak">
          0
         </span>
</div>
<div class="text-sm font-medium">
         ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü:
         <span id="points">
          0
         </span>
</div>
</div>
<div class="mt-4">
<button class="px-3 py-2 rounded-lg border border-slate-700" id="openClass">
         ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø / ‡¶Æ‡ßã‡¶° ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
</div>
</div>
</section>
<!-- Middle column: Game selector -->
<section class="col-span-1 md:col-span-1 bg-slate-800/30 p-5 rounded-2xl card-glow">
<h2 class="text-xl font-semibold mb-3">
       ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∂‡¶ø‡¶ñ‡ßÅ‡¶®
      </h2>
<div class="space-y-3">
<div class="grid gap-3">
<button class="gameBtn btn-primary px-4 py-3 rounded-lg text-left" data-game="dailyQuiz">
         üìö ‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶ï‡ßÅ‡¶á‡¶ú (5 ‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®)
        </button>
<button class="gameBtn btn-primary px-4 py-3 rounded-lg text-left" data-game="mathSprint">
         ‚úè ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶• ‡¶∏‡ßç‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü (‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÄ‡¶Æ‡¶æ)
        </button>
<button class="gameBtn btn-primary px-4 py-3 rounded-lg text-left" data-game="reactionGame">
         üèÉ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶û‡ßç‡¶ú
        </button>
</div>
<div class="mt-4 text-sm text-slate-300">
        ‡¶ó‡ßá‡¶Æ‡¶ó‡ßÅ‡¶≤‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø (1‚Äì12) ‡¶è‡¶¨‡¶Ç ‡¶Æ‡ßã‡¶° (‡¶∏‡¶π‡¶ú/‡¶Æ‡¶æ‡¶ù‡¶æ‡¶∞‡¶ø/‡¶π‡¶æ‡¶∞‡ßç‡¶°) ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ñ‡¶æ‡¶™ ‡¶ñ‡¶æ‡¶Ø‡¶º‡•§ ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡•§
       </div>
</div>
</section>
<!-- Right column: Active game area -->
<section class="col-span-1 md:col-span-1 bg-slate-900/40 p-5 rounded-2xl min-h-[320px] card-glow" id="gameArea">
<div id="gameContent">
<h2 class="text-lg font-semibold">
        ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!
       </h2>
<p class="text-sm text-slate-300">
        ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ö‡¶Ø‡¶º‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø 24 ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶ï‡ßÅ‡¶á‡¶ú‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
       </p>
</div>
</section>
</main>
<footer class="mt-6 text-xs text-slate-400">
     ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º ‡¶°‡ßá‡¶Æ‡ßã - ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶û‡ßç‡¶ö‡¶ø‡¶§‡•§ ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ/‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶¨‡ßà‡¶∂‡¶ø‡¶∑‡ßç‡¶ü‡ßç‡¶Ø‡¶ó‡ßÅ‡¶≤‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø, ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶Ü‡¶Æ‡¶ø ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶§‡¶æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø)‡•§
    </footer>
</div>
</div>
<!-- Authentication & Settings Modal (hidden by default) -->
<div class="fixed inset-0 flex items-center justify-center bg-black/60 hidden" id="modal">
<div class="bg-slate-900 rounded-2xl p-6 w-full max-w-2xl">
<div class="flex items-center justify-between mb-4">
<h3 class="text-xl font-bold">
      ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü - ‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡¶æ ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
     </h3>
<button class="text-slate-400" id="closeModal">
      ‚úñ
     </button>
</div>
<div class="grid md:grid-cols-2 gap-4">
<div class="space-y-3">
<div class="text-sm text-slate-300 font-semibold">
       ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ - ‡¶≤‡¶ó‡¶á‡¶®
      </div>
<input class="w-full p-2 rounded bg-slate-800/60" id="loginName" placeholder="‡¶®‡¶æ‡¶Æ"/>
<input class="w-full p-2 rounded bg-slate-800/60" id="loginPass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" type="password"/>
<button class="w-full mt-2 px-3 py-2 rounded btn-primary" id="loginBtn">
       ‡¶≤‡¶ó‡¶á‡¶®
      </button>
</div>
<div class="space-y-3">
<div class="text-sm text-slate-300 font-semibold">
       ‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ - ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
      </div>
<input class="w-full p-2 rounded bg-slate-800/60" id="regName" placeholder="‡¶™‡ßÅ‡¶∞‡ßã ‡¶®‡¶æ‡¶Æ"/>
<input class="w-full p-2 rounded bg-slate-800/60" id="regPass" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" type="password"/>
<select class="w-full p-2 rounded bg-slate-800/60" id="regClass">
<option value="6">
        ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 6
       </option>
<option value="7">
        ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 7
       </option>
<option value="8">
        ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 8
       </option>
<option value="9">
        ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 9
       </option>
<option value="10">
        ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 10
       </option>
<option value="11">
        ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 11
       </option>
<option value="12">
        ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 12
       </option>
</select>
<select class="w-full p-2 rounded bg-slate-800/60" id="regMode">
<option>
        ‡¶∏‡¶π‡¶ú
       </option>
<option selected="">
        ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ
       </option>
<option>
        ‡¶π‡¶æ‡¶∞‡ßç‡¶°
       </option>
</select>
<button class="w-full mt-2 px-3 py-2 rounded btn-primary" id="regBtn">
       ‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶è‡¶¨‡¶Ç ‡¶≤‡¶ó‡¶á‡¶®
      </button>
</div>
</div>
<div class="mt-3 text-sm text-amber-200" id="authMsg">
</div>
</div>
</div>
<!-- Class/Mode modal -->
<div class="fixed inset-0 flex items-center justify-center bg-black/50 hidden" id="classModal">
<div class="bg-slate-900 rounded-2xl p-6 w-full max-w-md">
<div class="flex items-center justify-between mb-4">
<h3 class="text-lg font-bold">
      ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶Æ‡ßã‡¶° ‡¶ö‡¶Ø‡¶º‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
     </h3>
<button class="text-slate-400" id="closeClass">
      ‚úñ
     </button>
</div>
<div class="space-y-3">
<label class="text-sm text-slate-300">
      ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏
     </label>
<select class="w-full p-2 rounded bg-slate-800/60" id="selClass">
<option value="6">
       ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 6
      </option>
<option value="7">
       ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 7
      </option>
<option value="8">
       ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 8
      </option>
<option value="9">
       ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 9
      </option>
<option value="10">
       ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 10
      </option>
<option value="11">
       ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 11
      </option>
<option value="12">
       ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ 12
      </option>
</select>
<label class="text-sm text-slate-300">
      ‡¶Æ‡ßã‡¶°
     </label>
<select class="w-full p-2 rounded bg-slate-800/60" id="selMode">
<option>
       ‡¶∏‡¶π‡¶ú
      </option>
<option selected="">
       ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ
      </option>
<option>
       ‡¶π‡¶æ‡¶∞‡ßç‡¶°
      </option>
</select>
<div class="flex gap-2 justify-end">
<button class="px-3 py-2 rounded border" id="saveClass">
       ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®
      </button>
</div>
</div>
</div>
</div>
<script>
   /* -----------------------------
       Simple in-browser user system
       - stores users in localStorage under key 'glh_users'
       - stores current session as 'glh_session'
       - daily quiz state keyed by date so questions refresh daily
       ------------------------------*/

    const LS_USERS = 'glh_users_v1';
    const LS_SESSION = 'glh_session_v1';

    // Utilities
    const $ = sel => document.querySelector(sel);
    const todayKey = () => {
      const d = new Date();
      return d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();
    };

    function loadUsers(){
      try{ return JSON.parse(localStorage.getItem(LS_USERS)||'{}'); }catch(e){return {}};
    }
    function saveUsers(u){ localStorage.setItem(LS_USERS, JSON.stringify(u)); }
    function saveSession(s){ localStorage.setItem(LS_SESSION, JSON.stringify(s)); }
    function loadSession(){ try{return JSON.parse(localStorage.getItem(LS_SESSION)||'null');}catch(e){return null} }

    function simpleHash(s){ return btoa(unescape(encodeURIComponent(s))).slice(0,32); }

    // Example question bank (extendable). Each item has class, subject, q, options, answer
    const QUESTION_BANK = [
      {cls:6,sub:'Math',q:'What is 7 √ó 8?',opts:['54','56','49','64'],a:'56'},
      {cls:6,sub:'Science',q:'Which is a gas at room temperature?',opts:['Iron','Oxygen','Water','Sand'],a:'Oxygen'},
      {cls:7,sub:'Math',q:'What is the LCM of 4 and 6?',opts:['6','12','8','24'],a:'12'},
      {cls:8,sub:'Physics',q:'What is the SI unit of force?',opts:['Joule','Newton','Pascal','Watt'],a:'Newton'},
      {cls:9,sub:'Math',q:'Solve: x+5=12. x=?',opts:['7','6','-7','5'],a:'7'},
      {cls:10,sub:'Chemistry',q:'pH of neutral water (approx)?',opts:['7','1','14','0'],a:'7'},
      {cls:11,sub:'Physics',q:'Acceleration due to gravity on Earth (approx m/s¬≤)?',opts:['9.8','5','12','15'],a:'9.8'},
      {cls:12,sub:'Math',q:'Derivative of x^2 is?',opts:['x','2x','x^2','2'],a:'2x'},
      // add more entries or create algorithmic questions later
    ];

    // ----- Auth handlers -----
    function registerUser(name, pass, cls, mode){
      const users = loadUsers();
      if(users[name]) return {ok:false,msg:'Name already taken'};
      users[name] = {pwd:simpleHash(pass),class:parseInt(cls,10)||6,mode:mode||'Medium',points:0,streak:0,lastQuiz: null};
      saveUsers(users);
      saveSession({name:name});
      return {ok:true};
    }
    function loginUser(name, pass){
      const users = loadUsers();
      if(!users[name]) return {ok:false,msg:'No such user'};
      if(users[name].pwd !== simpleHash(pass)) return {ok:false,msg:'Wrong password'};
      saveSession({name:name});
      return {ok:true};
    }

    // ----- Session & UI -----
    function updateHeader(){
      const sess = loadSession();
      if(!sess){ $('#welcome').innerText='Guest'; $('#profileBox').querySelector('div').innerText='Not logged in'; return; }
      const users = loadUsers();
      const u = users[sess.name];
      $('#welcome').innerText = sess.name + ' ‚Ä¢ Class ' + u.class + ' ‚Ä¢ ' + u.mode;
      $('#profileBox').querySelector('div').innerText = '';
      $('#points').innerText = u.points || 0;
      $('#streak').innerText = u.streak || 0;
    }

    // ----- Daily quiz lock timer -----
    let timerInterval = null;
    function startDailyTimer(){
      clearInterval(timerInterval);
      const sess = loadSession();
      if(!sess){ $('#dailyTimer').innerText='--:--:--'; return; }
      const users = loadUsers();
      const u = users[sess.name];
      const last = u.lastQuiz ? new Date(u.lastQuiz) : null;
      const now = new Date();
      if(!last){ $('#dailyTimer').innerText='Ready'; return; }
      const msPassed = now - last;
      const msDay = 24*60*60*1000;
      if(msPassed >= msDay){ $('#dailyTimer').innerText='Ready'; return; }
      const remaining = msDay - msPassed;
      function tick(){
        const rem = msDay - (new Date() - new Date(u.lastQuiz));
        if(rem<=0){ $('#dailyTimer').innerText='Ready'; clearInterval(timerInterval); return; }
        const s = Math.floor(rem/1000)%60;
        const m = Math.floor(rem/60000)%60;
        const h = Math.floor(rem/3600000);
        $('#dailyTimer').innerText = String(h).padStart(2,'0')+':'+String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
      }
      tick(); timerInterval = setInterval(tick,1000);
    }

    // ----- Game system -----
    const gameContent = $('#gameContent');

    function chooseQuestionsForUser(n=5){
      const sess = loadSession();
      const users = loadUsers();
      if(!sess) return [];
      const u = users[sess.name];
      const cls = u.class;
      // Filter bank by class or lower classes
      const pool = QUESTION_BANK.filter(q=>q.cls<=cls+0);
      // shuffle
      const arr = pool.slice();
      for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
      return arr.slice(0,n);
    }

    function renderDailyQuiz(){
      const sess = loadSession();
      if(!sess){ gameContent.innerHTML = '<div class="text-sm">Please login to play the Daily Quiz.</div>'; return; }
      // check timer
      const users = loadUsers(); const u = users[sess.name];
      const last = u.lastQuiz ? new Date(u.lastQuiz) : null;
      if(last && (new Date()-last) < 24*60*60*1000){ gameContent.innerHTML = '<div class="text-sm">Daily Quiz already completed. Come back later.</div>'; return; }
      const qs = chooseQuestionsForUser(5);
      if(qs.length===0){ gameContent.innerHTML='<div class="text-sm">Not enough questions for your class. Add more to the bank.</div>'; return; }

      let html = '<h3 class="text-lg font-semibold mb-2">Daily Quiz ‚Äî 5 Qs</h3>';
      html += '<form id="quizForm" class="space-y-4">';
      qs.forEach((q,i)=>{
        html += `<div class="p-3 bg-slate-800/40 rounded">
                  <div class="font-medium">${i+1}. ${q.q}</div>
                  <div class="grid grid-cols-2 gap-2 mt-2">`;
        q.opts.forEach(opt=>{
          html += `<label class="p-2 border rounded cursor-pointer"><input type="radio" name="q${i}" value="${opt}" class="mr-2"> ${opt}</label>`;
        });
        html += '</div></div>';
      });
      html += '<div class="flex gap-2 justify-end"><button type="submit" class="px-4 py-2 rounded btn-primary">Submit Quiz</button></div>';
      html += '</form>';
      gameContent.innerHTML = html;

      $('#quizForm').addEventListener('submit', e=>{
        e.preventDefault();
        const form = new FormData(e.target);
        let score=0;
        qs.forEach((q,i)=>{ if(form.get('q'+i) === q.a) score++; });
        // update user points & streak
        users[sess.name].points = (users[sess.name].points||0) + score*10 + 20; // base bonus
        const yesterday = new Date(); yesterday.setDate(yesterday.getDate()-1);
        const lastQuizDay = users[sess.name].lastQuiz ? new Date(users[sess.name].lastQuiz) : null;
        if(lastQuizDay && lastQuizDay.toDateString() === yesterday.toDateString()){
          users[sess.name].streak = (users[sess.name].streak||0) + 1;
        } else { users[sess.name].streak = 1; }
        users[sess.name].lastQuiz = new Date().toISOString();
        saveUsers(users);
        saveSession({name:sess.name});
        updateHeader(); startDailyTimer();
        gameContent.innerHTML = `<div class="p-4 rounded bg-slate-800/50">You scored <strong>${score}</strong> / ${qs.length}. Points updated.</div>`;
      });
    }

    // Math Sprint: fast arithmetic questions, timed
    function renderMathSprint(){
      const sess = loadSession();
      const users = loadUsers();
      const u = sess? users[sess.name] : null;
      let timeLeft = 45; // seconds
      let score = 0; let qCount=0;
      gameContent.innerHTML = `<div>
        <div class="flex justify-between items-center mb-2"><div class="text-lg font-semibold">Math Sprint ‚Äî solve quickly</div><div class="text-sm">Time: <span id="msTimer">${timeLeft}</span>s</div></div>
        <div id="msQuestion" class="p-4 bg-slate-800/40 rounded mb-3"></div>
        <div class="flex gap-2"><input id="msAnswer" class="p-2 rounded bg-slate-800/60" placeholder="Answer"><button id="msSubmit" class="px-3 py-2 rounded btn-primary">Submit</button></div>
        <div class="mt-3 text-sm text-slate-300">Score: <span id="msScore">0</span></div>
      </div>`;
      const qEl = $('#msQuestion'); const tEl = $('#msTimer'); const aEl = $('#msAnswer'); const scEl = $('#msScore');

      function makeQuestion(){
        const a = Math.ceil(Math.random()*12*(u? (u.class/6):1));
        const b = Math.ceil(Math.random()*12*(u? (u.class/6):1));
        const op = ['+','-','√ó','√∑'][Math.floor(Math.random()*4)];
        let qtext,ans;
        if(op==='+'){ ans = a+b; qtext=`${a} + ${b}`;} 
        if(op==='-'){ ans = a-b; qtext=`${a} - ${b}`;} 
        if(op==='√ó'){ ans = a*b; qtext=`${a} √ó ${b}`;} 
        if(op==='√∑'){ ans = Math.round((a/b)*100)/100; qtext=`${a} √∑ ${b} (rounded 2dp)`; }
        qCount++; qEl.innerHTML = `<div class="font-medium">Q${qCount}: ${qtext}</div>`;
        return ans;
      }

      let correctAns = makeQuestion();
      aEl.focus();
      const msTimer = setInterval(()=>{
        timeLeft--; tEl.innerText=timeLeft; if(timeLeft<=0){ clearInterval(msTimer); endSprint(); }
      },1000);

      function endSprint(){
        $('#msSubmit').disabled=true; aEl.disabled=true;
        if(sess){ users[sess.name].points = (users[sess.name].points||0)+score*5; saveUsers(users); updateHeader(); }
        gameContent.innerHTML = `<div class="p-4 rounded bg-slate-800/50">Sprint over ‚Äî Score: ${score}</div>`;
      }

      $('#msSubmit').addEventListener('click', ()=>{
        const val = aEl.value.trim(); if(!val) return;
        // compare with tolerance for division
        const numeric = parseFloat(val);
        if(Math.abs(numeric - correctAns) < 0.005){ score+=2; } else { score-=1; }
        scEl.innerText = score; aEl.value=''; correctAns = makeQuestion(); aEl.focus();
      });
    }

    // Reaction Game: click moving targets
    function renderReactionGame(){
      let timeLeft = 20; let score = 0;
      gameContent.innerHTML = `<div>
        <div class="flex justify-between items-center mb-2"><div class="text-lg font-semibold">Reaction Challenge</div><div class="text-sm">Time: <span id="rgTimer">${timeLeft}</span>s</div></div>
        <div id="arena" class="relative w-full h-56 bg-slate-800/20 rounded"></div>
        <div class="mt-3 text-sm">Score: <span id="rgScore">0</span></div>
      </div>`;
      const arena = $('#arena'); const tEl = $('#rgTimer'); const sEl = $('#rgScore');
      const spawn = ()=>{
        arena.innerHTML='';
        const target = document.createElement('div');
        target.className='game-target bg-amber-400';
        target.style.left = Math.random()*(arena.clientWidth-60)+'px';
        target.style.top = Math.random()*(arena.clientHeight-60)+'px';
        target.style.background = 'linear-gradient(135deg,#f59e0b,#ef4444)';
        arena.appendChild(target);
        target.addEventListener('click', ()=>{ score+=1; sEl.innerText=score; spawn(); });
      };
      spawn();
      const rgTimer = setInterval(()=>{ timeLeft--; tEl.innerText=timeLeft; if(timeLeft<=0){ clearInterval(rgTimer); arena.innerHTML='<div class="p-4">Time up ‚Äî Score: '+score+'</div>'; const sess=loadSession(); if(sess){ const users=loadUsers(); users[sess.name].points=(users[sess.name].points||0)+score*3; saveUsers(users); updateHeader(); } } },1000);
    }

    // ----- Event wiring -----
    document.addEventListener('DOMContentLoaded', ()=>{
      updateHeader(); startDailyTimer();
      // open modal
      $('#openAuth').addEventListener('click', ()=>{ $('#modal').classList.remove('hidden'); });
      $('#closeModal').addEventListener('click', ()=>{ $('#modal').classList.add('hidden'); });
      $('#openClass').addEventListener('click', ()=>{ $('#classModal').classList.remove('hidden'); const s=loadSession(); if(s){ const u = loadUsers()[s.name]; $('#selClass').value = u.class; $('#selMode').value = u.mode; } });
      $('#closeClass').addEventListener('click', ()=>{ $('#classModal').classList.add('hidden'); });
      $('#saveClass').addEventListener('click', ()=>{
        const s = loadSession(); if(!s) return alert('Login first'); const users = loadUsers(); const u = users[s.name]; u.class = parseInt($('#selClass').value,10); u.mode = $('#selMode').value; saveUsers(users); updateHeader(); $('#classModal').classList.add('hidden');
      });

      // register & login
      $('#regBtn').addEventListener('click', ()=>{
        const name = $('#regName').value.trim(); const pass = $('#regPass').value; const cls = $('#regClass').value; const mode = $('#regMode').value;
        if(!name||!pass) { $('#authMsg').innerText='Fill name & password'; return; }
        const r = registerUser(name,pass,cls,mode);
        if(!r.ok) { $('#authMsg').innerText = r.msg; return; }
        $('#authMsg').innerText='Registered and logged in!'; $('#modal').classList.add('hidden'); updateHeader(); startDailyTimer();
      });
      $('#loginBtn').addEventListener('click', ()=>{
        const name = $('#loginName').value.trim(); const pass = $('#loginPass').value;
        const r = loginUser(name,pass);
        if(!r.ok){ $('#authMsg').innerText=r.msg; return; }
        $('#authMsg').innerText='Logged in!'; $('#modal').classList.add('hidden'); updateHeader(); startDailyTimer();
      });

      // game buttons
      document.querySelectorAll('.gameBtn').forEach(b=>{
        b.addEventListener('click', ()=>{
          const g = b.dataset.game;
          if(g==='dailyQuiz') renderDailyQuiz();
          if(g==='mathSprint') renderMathSprint();
          if(g==='reactionGame') renderReactionGame();
        });
      });

      // quick demo: open daily if ready
      // if you want Daily Quiz visible on load uncomment below
      // renderDailyQuiz();
    });

    // Expose for debugging in console
    window.__GLH = {loadUsers, saveUsers, loadSession, saveSession};
  </script>
</body>
</html>
